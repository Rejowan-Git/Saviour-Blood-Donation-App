<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Saviour | Advanced Blood Platform</title>
    
	<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
	<script src="https://cdn.tailwindcss.com"></script>
    
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
	<script src="https://unpkg.com/@phosphor-icons/web"></script>

	<script>
		tailwind.config = {
			theme: {
				extend: {
					fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] },
					colors: { brand: { 50:'#fff1f2', 100:'#ffe4e6', 500:'#f43f5e', 600:'#e11d48', 900:'#881337' } }
				}
			}
		}
	</script>

	<!-- Landing redirect removed: auth pages were removed per request -->

	<style>
		/* Smooth inputs */
		.input-field {
			width: 100%;
			padding: 1rem;
			background-color: #f8fafc;
			border: 1px solid #c91f1f;
			border-radius: 0.75rem;
			outline: none;
			transition: all 0.2s;
		}
		.input-field:focus {
			background-color: rgb(245, 238, 238);
			border-color: #e11d48;
			box-shadow: 0 0 0 4px rgba(225, 29, 72, 0.1);
		}

		/* Navigation Links */
		.nav-link {
			font-weight: 600;
			color: #000000;
			transition: color 0.2s;
			position: relative;
		}
		.nav-link:hover {
			color: #e00000;
		}
        
		/* View Switching Logic */
		.view {
			display: none;
		}
		.view.active {
			display: block;
			animation: fadeIn 0.4s ease-out;
		}

		@keyframes fadeIn {
			from { opacity: 0; transform: translateY(10px); }
			to { opacity: 1; transform: translateY(0); }
		}

		/* Map Popup Styling */
		.leaflet-popup-content-wrapper {
			border-radius: 12px;
			padding: 5px;
			box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
		}
		.leaflet-popup-content {
			font-family: 'Plus Jakarta Sans', sans-serif;
			font-size: 14px;
			margin: 10px;
		}
        
		/* Custom Scrollbar */
		::-webkit-scrollbar { width: 8px; }
		::-webkit-scrollbar-track { background: #f1f1f1; }
		::-webkit-scrollbar-thumb { background: #e11d48; border-radius: 10px; }
	</style>
	<!-- Local styles for donor card feed -->
	<link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-slate-50 text-slate-800 relative">

	<nav class="fixed w-full z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 transition-all duration-300">
		<div class="max-w-7xl mx-auto px-4">
			<div class="flex justify-between h-20 items-center">
				<button id="backFromExplore" class="back-btn" aria-label="Back">‚Üê</button>
				<div class="flex items-center gap-2 cursor-pointer group" onclick="app.router('home')">
					<div class="bg-brand-600 text-white p-2 rounded-lg shadow-lg group-hover:scale-105 transition-transform">
						<i class="ph-bold ph-drop-half-bottom text-2xl"></i>
					</div>
					<span class="font-extrabold text-2xl tracking-tight text-slate-900">Saviour<span class="text-brand-600">Pro</span></span>
				</div>
                
				<div class="hidden md:flex items-center space-x-6">
					<button onclick="app.router('home')" class="nav-link">Home</button>
					<button onclick="app.router('map-view')" class="nav-link flex items-center gap-1"><i class="ph-bold ph-map-trifold"></i> Live Map</button>
					<button onclick="app.router('dashboard')" class="nav-link flex items-center gap-1"><i class="ph-bold ph-chart-pie-slice"></i> Dashboard</button>
					<!-- Auth pages removed; login/signup buttons intentionally removed -->
					<button onclick="app.router('donate')" class="bg-slate-900 text-white px-6 py-2.5 rounded-full font-bold hover:bg-brand-600 transition shadow-lg hover:shadow-brand-500/30 transform hover:-translate-y-0.5">
						Register as Donor
					</button>
				</div>
                
				<div class="md:hidden text-2xl text-slate-600">
					<i class="ph ph-list"></i>
				</div>
			</div>
		</div>
	</nav>

	<div class="h-20"></div>

	<main id="app-container" class="min-h-screen">
        
		<section id="home" class="view active">
			<div class="relative bg-slate-900 text-white py-24 overflow-hidden rounded-b-[3rem]">
				<div class="absolute inset-0 opacity-20 bg-[url('https://images.unsplash.com/photo-1579154204601-01588f351e67?q=80&w=2070')] bg-cover bg-center"></div>
                
				<div class="max-w-7xl mx-auto px-4 relative z-10 text-center">
					<span class="inline-block py-1 px-3 rounded-full bg-brand-900/50 border border-brand-500/30 text-brand-100 text-sm font-bold mb-6 backdrop-blur-sm">
						Blood Donation Platform in Bangladesh
					</span>
					<h1 class="text-5xl md:text-7xl font-extrabold mb-6 leading-tight">Connected for <span class="text-brand-500">Life</span></h1>
					<p class="text-xl text-slate-300 mb-10 max-w-2xl mx-auto leading-relaxed">
						Real-time donor tracking across Dhaka,Chittagong and beyond.Find a hero or become one today.
					</p>
					<div class="flex flex-col sm:flex-row justify-center gap-4">
						<button onclick="app.router('map-view')" class="bg-brand-600 text-white px-8 py-4 rounded-full font-bold text-lg hover:bg-brand-500 transition shadow-lg shadow-brand-900/20">
							Find on Map
						</button>
						<button onclick="app.router('dashboard')" class="bg-white/10 backdrop-blur text-white border border-white/20 px-8 py-4 rounded-full font-bold text-lg hover:bg-white/20 transition">
							View Stats
						</button>
					</div>
				</div>
			</div>

			<div class="max-w-7xl mx-auto px-4 py-16">
				<div class="flex flex-col md:flex-row justify-between items-end mb-8 gap-4">
					<div>
						<h2 class="bg-slate-900 text-white px-6 py-2.5 rounded-full font-bold hover:bg-brand-600 transition shadow-lg hover:shadow-brand-500/30 transform hover:-translate-y-0.5">Donor Feed</h2>
						
					</div>
					<div class="relative w-full md:w-auto">
						<i class="ph ph-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 text-lg"></i>
						<input type="text" id="searchInput" placeholder="Search (e.g. A+, Dhaka)" 
							   class="pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none w-full md:w-80 shadow-sm transition-all">
					</div>
				</div>

				<div id="donor-grid" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
				</div>

				<!-- Demo donor feed using local card styles (100 cards will be appended) -->
				<div class="mt-8">
					<h3 class="text-2xl font-bold text-slate-900 mb-3"></h3>
					<div id="donor-list" class="feed" aria-live="polite"></div>
				</div>
			</div>
		</section>

		<section id="map-view" class="view">
			<div class="h-[calc(100vh-80px)] w-full relative">
				<div id="map" class="h-full w-full z-0 bg-slate-200"></div>
                
				<div class="absolute top-4 left-4 bg-white/90 backdrop-blur p-5 rounded-2xl shadow-2xl z-[1000] w-72 border border-slate-100">
					<h3 class="font-bold text-lg mb-2 flex items-center gap-2"><i class="ph-fill ph-broadcast text-brand-600 animate-pulse"></i> Live Activity</h3>
					<p class="text-xs text-slate-500 mb-4">Showing active donors near you.</p>
					<div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
						<span class="px-3 py-1 bg-red-100 text-red-700 text-xs font-bold rounded-full whitespace-nowrap border border-red-200">A+ High Demand</span>
						<span class="px-3 py-1 bg-blue-100 text-blue-700 text-xs font-bold rounded-full whitespace-nowrap border border-blue-200">Dhaka</span>
					</div>
				</div>
			</div>
		</section>

		<section id="dashboard" class="view">
			<div class="max-w-7xl mx-auto px-4 py-12">
				<div class="flex items-center justify-between mb-8">
					<h2 class="text-3xl font-bold text-slate-900">Analytics Dashboard</h2>
					<button class="text-sm font-bold text-brand-600 bg-brand-50 px-4 py-2 rounded-lg">Last 30 Days</button>
				</div>
                
				<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
					<div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
						<div class="flex items-center justify-between mb-4">
							<p class="text-slate-500 text-xs font-bold uppercase tracking-wider">Total Donors</p>
							<i class="ph-duotone ph-users text-2xl text-brand-500"></i>
						</div>
						<h3 class="text-4xl font-extrabold text-slate-900" id="stat-total-donors">0</h3>
						<p class="text-xs text-green-600 font-bold mt-2">‚Üë 12% increase</p>
					</div>
					<div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
						<div class="flex items-center justify-between mb-4">
							<p class="text-slate-500 text-xs font-bold uppercase tracking-wider">Requests Today</p>
							<i class="ph-duotone ph-bell-ringing text-2xl text-blue-500"></i>
						</div>
						<h3 class="text-4xl font-extrabold text-slate-900">14</h3>
						<p class="text-xs text-slate-400 font-bold mt-2">Active now</p>
					</div>
					<div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
						<div class="flex items-center justify-between mb-4">
							<p class="text-slate-500 text-xs font-bold uppercase tracking-wider">Lives Impacted</p>
							<i class="ph-duotone ph-heart text-2xl text-red-500"></i>
						</div>
						<h3 class="text-4xl font-extrabold text-slate-900">1,204</h3>
						<p class="text-xs text-green-600 font-bold mt-2">Since launch</p>
					</div>
				</div>

				<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
					<div class="bg-white p-8 rounded-3xl shadow-lg border border-slate-100">
						<h4 class="font-bold text-lg mb-6 text-slate-800">Blood Group Distribution</h4>
						<div class="h-64 flex justify-center">
							<canvas id="bloodChart"></canvas>
						</div>
					</div>
					<div class="bg-white p-8 rounded-3xl shadow-lg border border-slate-100">
						<h4 class="font-bold text-lg mb-6 text-slate-800">Donation Activity (2025)</h4>
						<div class="h-64">
							<canvas id="activityChart"></canvas>
						</div>
					</div>
				</div>
			</div>
		</section>

		<section id="donate" class="view">
			<div class="max-w-3xl mx-auto px-4 py-16">
				<div class="bg-white p-8 md:p-12 rounded-[2rem] shadow-2xl border border-slate-100 relative overflow-hidden">
					<div class="absolute top-0 right-0 w-64 h-64 bg-brand-50 rounded-bl-full -z-10"></div>
                    
					<div class="mb-8">
						<h2 class="text-3xl font-bold text-slate-900 mb-2">Join the Network</h2>
						<p class="text-slate-500">Registering takes 1 minute and saves lives forever.</p>
					</div>

					<form id="donorForm" class="space-y-6">
						<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
							<div>
								<label class="block text-sm font-bold text-slate-700 mb-2">Full Name</label>
								<input type="text" id="d-name" placeholder="ex. Rahim Ahmed" required class="input-field">
							</div>
							<div>
								<label class="block text-sm font-bold text-slate-700 mb-2">Age</label>
								<input type="number" id="d-age" placeholder="ex. 24" required class="input-field">
							</div>
						</div>
                        
						<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
							<div>
								<label class="block text-sm font-bold text-slate-700 mb-2">Blood Group</label>
								<select id="d-group" class="input-field cursor-pointer">
									<option value="A+">A+</option><option value="A-">A-</option>
									<option value="B+">B+</option><option value="B-">B-</option>
									<option value="O+">O+</option><option value="O-">O-</option>
									<option value="AB+">AB+</option><option value="AB-">AB-</option>
								</select>
							</div>
							<div>
								<label class="block text-sm font-bold text-slate-700 mb-2">City</label>
								<select id="d-city" class="input-field cursor-pointer">
									<option value="Dhaka">Dhaka</option>
									<option value="Chittagong">Chittagong</option>
									<option value="Sylhet">Sylhet</option>
									<option value="Rajshahi">Rajshahi</option>
									<option value="Khulna">Khulna</option>
								</select>
							</div>
						</div>
                        
						<div class="pt-4">
							<button type="submit" class="w-full bg-slate-900 text-white py-4 rounded-xl font-bold text-lg hover:bg-brand-600 transition shadow-xl hover:shadow-brand-500/20 transform hover:-translate-y-1">
								Complete Registration
							</button>
						</div>
					</form>
				</div>
			</div>
		</section>
	</main>

	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

	<script>
		const app = {
			// State
			donors: [],
			map: null,
			bloodChart: null,
            
			// Initialize App
			init: function() {
				this.loadData();
				this.setupEventListeners();
				this.router('home'); // Start at home
			},

			// Data Handling (LocalStorage)
			loadData: function() {
				const stored = localStorage.getItem('saviour_donors');
				if (stored) {
					this.donors = JSON.parse(stored);
				} else {
					// Seed Mock Data for first time users
					this.donors = [
						{ id: 1, name: "Rahim A.", group: "A+", city: "Dhaka", lat: 23.8103, lng: 90.4125 },
						{ id: 2, name: "Karim B.", group: "O-", city: "Chittagong", lat: 22.3569, lng: 91.7832 },
						{ id: 3, name: "Sujon K.", group: "B+", city: "Sylhet", lat: 24.8949, lng: 91.8687 },
						{ id: 4, name: "Nusrat J.", group: "AB+", city: "Dhaka", lat: 23.7925, lng: 90.4078 },
						{ id: 5, name: "Farhana", group: "O+", city: "Rajshahi", lat: 24.3636, lng: 88.6241 }
					];
					this.saveData();
				}
				this.renderDonors(); // Initial Render
				this.updateStats();
			},

			saveData: function() {
				localStorage.setItem('saviour_donors', JSON.stringify(this.donors));
				this.updateStats();
			},

			// Routing System
			router: function(viewId) {
				// Hide all views
				document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
                
				// Show target view
				const target = document.getElementById(viewId);
				if(target) {
					target.classList.add('active');
					window.scrollTo({ top: 0, behavior: 'smooth' });
				}

				// View specific init
				if (viewId === 'map-view') {
					setTimeout(() => this.initMap(), 200); // Slight delay for DOM stability
				}
				if (viewId === 'dashboard') {
					setTimeout(() => this.initCharts(), 200);
				}
			},

			// Map Logic
			initMap: function() {
				if (this.map) {
					this.map.invalidateSize(); // Fix grey map issue
					return; 
				}

				// Center on Bangladesh
				this.map = L.map('map').setView([23.6850, 90.3563], 7);

				L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
					attribution: '&copy; OpenStreetMap & CartoDB',
					maxZoom: 19
				}).addTo(this.map);

				// Add pins
				this.donors.forEach(d => {
					const marker = L.marker([d.lat, d.lng]).addTo(this.map);
					marker.bindPopup(`
						<div class="text-center">
							<h4 class="font-bold text-slate-800 text-base">${d.name}</h4>
							<span class="inline-block bg-brand-100 text-brand-600 px-2 py-1 rounded text-xs font-bold mt-1">${d.group}</span>
							<p class="text-xs text-slate-500 mt-1">${d.city}</p>
						</div>
					`);
				});
			},

			// Charts Logic
			initCharts: function() {
				// Prepare Data
				const groups = this.donors.reduce((acc, curr) => {
					acc[curr.group] = (acc[curr.group] || 0) + 1;
					return acc;
				}, {});

				// Destroy old chart to prevent stacking
				if(this.bloodChart) {
					this.bloodChart.destroy();
				}

				const ctx1 = document.getElementById('bloodChart').getContext('2d');
				this.bloodChart = new Chart(ctx1, {
					type: 'doughnut',
					data: {
						labels: Object.keys(groups),
						datasets: [{
							data: Object.values(groups),
							backgroundColor: ['#f43f5e', '#ec4899', '#8b5cf6', '#14b8a6', '#f59e0b', '#3b82f6'],
							borderWidth: 0
						}]
					},
					options: {
						responsive: true,
						maintainAspectRatio: false,
						plugins: {
							legend: { position: 'right' }
						}
					}
				});

				// Simple Activity Line Chart
				const ctx2 = document.getElementById('activityChart').getContext('2d');
				// Check if chart instance exists on canvas (Chart.js 3+ method)
				const existingChart = Chart.getChart("activityChart");
				if (existingChart) existingChart.destroy();

				new Chart(ctx2, {
					type: 'line',
					data: {
						labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
						datasets: [{
							label: 'New Donors',
							data: [12, 19, 8, 15, 22, this.donors.length],
							borderColor: '#0f172a',
							backgroundColor: 'rgba(15, 23, 42, 0.1)',
							fill: true,
							tension: 0.4
						}]
					},
					options: {
						responsive: true,
						maintainAspectRatio: false
					}
				});
			},

			// Rendering Logic
			renderDonors: function(filterText = '') {
				const grid = document.getElementById('donor-grid');
				grid.innerHTML = '';
                
				const filtered = this.donors.filter(d => 
					d.name.toLowerCase().includes(filterText) || 
					d.group.toLowerCase().includes(filterText) ||
					d.city.toLowerCase().includes(filterText)
				);

				filtered.forEach(d => {
					const card = document.createElement('div');
					card.className = "bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-xl hover:-translate-y-1 transition duration-300 flex flex-col items-center text-center group";
					card.innerHTML = `
						<div class="relative mb-4">
							<div class="w-20 h-20 rounded-full bg-slate-100 flex items-center justify-center text-3xl border-4 border-white shadow-md">
								üë§
							</div>
							<div class="absolute bottom-0 right-0 bg-brand-600 text-white text-xs font-bold px-2 py-1 rounded-full border-2 border-white">
								${d.group}
							</div>
						</div>
						<h4 class="font-bold text-slate-900 text-lg">${d.name}</h4>
						<p class="text-sm text-slate-500 mb-4 flex items-center gap-1">
							<i class="ph-fill ph-map-pin"></i> ${d.city}
						</p>
						<button onclick="app.contactDonor('${d.name}')" class="w-full py-2.5 bg-slate-50 text-slate-700 font-bold rounded-xl hover:bg-brand-600 hover:text-white transition group-hover:shadow-lg">
							Contact
						</button>
					`;
					grid.appendChild(card);
				});
			},

			updateStats: function() {
				const el = document.getElementById('stat-total-donors');
				if(el) el.innerText = this.donors.length;
			},

			// Interaction Logic
			setupEventListeners: function() {
				// Search Input
				document.getElementById('searchInput').addEventListener('input', (e) => {
					this.renderDonors(e.target.value.toLowerCase());
				});

				// Registration Form
				document.getElementById('donorForm').addEventListener('submit', (e) => {
					e.preventDefault();
                    
					const name = document.getElementById('d-name').value;
					const group = document.getElementById('d-group').value;
					const city = document.getElementById('d-city').value;
                    
					// Coordinates simulation based on city
					const baseCoords = { 
						'Dhaka': [23.8103, 90.4125], 
						'Chittagong': [22.3569, 91.7832], 
						'Sylhet': [24.8949, 91.8687], 
						'Rajshahi': [24.3636, 88.6241],
						'Khulna': [22.8456, 89.5403]
					};
					const coords = baseCoords[city] || [23.8, 90.4];
                    
					// Add slight random offset so markers don't stack perfectly
					const lat = coords[0] + (Math.random() - 0.5) * 0.05;
					const lng = coords[1] + (Math.random() - 0.5) * 0.05;

					const newDonor = {
						id: Date.now(),
						name, group, city, lat, lng
					};

					// Update State
					this.donors.unshift(newDonor); // Add to top
					this.saveData();
					this.renderDonors();

					// Notification
					Toastify({
						text: "üéâ Registration Successful! Welcome to Saviour.",
						duration: 3000,
						gravity: "top", 
						position: "right", 
						style: { background: "linear-gradient(to right, #059669, #10b981)", borderRadius: "10px" }
					}).showToast();

					// Redirect
					this.router('home');
					e.target.reset();
				});
			},

			contactDonor: function(name) {
				Toastify({
					text: `üì® Request sent to ${name}`,
					duration: 3000,
					gravity: "bottom", 
					position: "center", 
					style: { background: "#3b82f6", borderRadius: "50px", fontWeight: "bold" }
				}).showToast();
			}
		};

		// Start App when DOM is ready
		document.addEventListener('DOMContentLoaded', () => {
			app.init();
		});
	</script>
	<!-- Local app script that contains donor-card helper -->
	<script src="js/app.js"></script>

	<script>
	  // Back button for explore page
	  document.addEventListener('DOMContentLoaded', function(){
		const b = document.getElementById('backFromExplore');
		if(b) b.addEventListener('click', ()=> window.history.back());
	  });
	</script>

	<script>
		// Populate 50 example donor records and persist to `localStorage` if storage has fewer than 50 donors.
		// This makes the demo donors available to the rest of the app (map, charts, renderers).
		document.addEventListener('DOMContentLoaded', () => {
			if (typeof createDonorElement !== 'function') return;

			const sampleNames = ['Mahir Hasan','Rahim Ahmed','Karim Bhuiyan','Sujon Khan','Nusrat Jahan','Farhana Akter','Arif Shohag','Mita Rahman','Sabbir Karim','Rita Laila','Tanim S.','Rashed M.','Nabila H.','Javed U.','Anika R.','Ibrahim K.','Samiha A.','Nazmul H.','Rumana P.','Fahim Z.'];
			const sampleCities = ['Dhaka','Mirpur DOHS, Dhaka','Mohammadpur, Dhaka','Chittagong','Sylhet','Rajshahi','Khulna','Comilla','Gazipur'];
			const bloodGroups = ['A+','A-','B+','B-','O+','O-','AB+','AB-'];

			// city -> coords map (approx)
			const baseCoords = {
				'Dhaka': [23.8103, 90.4125],
				'Mirpur DOHS, Dhaka': [23.8200, 90.3600],
				'Mohammadpur, Dhaka': [23.7500, 90.3560],
				'Chittagong': [22.3569, 91.7832],
				'Sylhet': [24.8949, 91.8687],
				'Rajshahi': [24.3636, 88.6241],
				'Khulna': [22.8456, 89.5403],
				'Comilla': [23.4591, 91.1809],
				'Gazipur': [24.0017, 90.4264]
			};

			const sampleDonors = [];
			for (let i = 1; i <= 50; i++){
				const name = sampleNames[i % sampleNames.length] + ' ' + (100 + i);
				const group = bloodGroups[i % bloodGroups.length];
				const city = sampleCities[i % sampleCities.length];
				const imgId = ((i % 70) + 1);
				const coords = baseCoords[city] || baseCoords['Dhaka'];
				const lat = coords[0] + (Math.random() - 0.5) * 0.02;
				const lng = coords[1] + (Math.random() - 0.5) * 0.02;
				sampleDonors.push({
					id: Date.now() + i,
					name,
					group,
					city,
					division: 'Dhaka',
					district: city.split(',')[0] || city,
					lastDonation: randomPastDate(),
					avatarUrl: `https://i.pravatar.cc/140?img=${imgId}`,
					lat, lng
				});
			}

			// Merge into localStorage if there are fewer than 50 donors stored
			try{
				const stored = JSON.parse(localStorage.getItem('saviour_donors') || '[]');
				if (!stored || stored.length < 50){
					// Place sample donors at the start so they appear first in feeds
					const merged = sampleDonors.concat(stored || []);
					localStorage.setItem('saviour_donors', JSON.stringify(merged));

					// If `app` exists, update its state and re-render/save
					if (window.app){
						app.donors = merged.slice();
						app.saveData(); // writes to localStorage and updates stats
						app.renderDonors();
						// If map already exists, add markers for new sample donors
						if (app.map && typeof L !== 'undefined'){
							sampleDonors.forEach(d => {
								if (d.lat && d.lng){
									const marker = L.marker([d.lat, d.lng]).addTo(app.map);
									marker.bindPopup(`<div class="text-center"><h4 class="font-bold text-slate-800 text-base">${escapeHtml(d.name)}</h4><span class="inline-block bg-brand-100 text-brand-600 px-2 py-1 rounded text-xs font-bold mt-1">${escapeHtml(d.group)}</span><p class="text-xs text-slate-500 mt-1">${escapeHtml(d.city)}</p></div>`);
								}
							});
						}
					}
				}
			}catch(e){ console.warn('Could not seed sample donors', e); }
		});
	</script>
		<script>
			// Add 10 lightweight demo cards into the Donor Feed (`#donor-list`) on first load
			document.addEventListener('DOMContentLoaded', () => {
				const list = document.getElementById('donor-list');
				if (!list || typeof createLightDonorElement !== 'function') return;

				const existing = list.children.length;
				const need = Math.max(0, 10 - existing);
				if (!need) return;

				const names = ['Mahir Hasan','Rahim A.','Karim B.','Sujon K.','Nusrat J.','Farhana','Arif S','Mita R','Sabbir K','Rita L'];
				const cities = ['Mirpur DOHS, Dhaka','Dhaka','Chittagong','Sylhet','Rajshahi'];
				const bloods = ['A+','A-','B+','B-','O+','O-','AB+','AB-'];

				const frag = document.createDocumentFragment();
				for (let i = 0; i < need; i++){
					const idx = (i + existing) % names.length;
					const d = {
						name: names[idx] + ' ' + (i+1),
						blood: bloods[(i+3) % bloods.length],
						city: cities[(i+2) % cities.length],
						division: 'Dhaka',
						district: 'Dhaka',
						lastDonation: randomPastDate(),
						avatarUrl: `https://i.pravatar.cc/140?img=${(i%70)+1}`
					};
					const el = createLightDonorElement(d);
					frag.appendChild(el);
				}
				list.appendChild(frag);
			});
		</script>
</body>
</html>
